{"version":3,"file":"module.viewer.js","sources":["../../../node_modules/@babel/runtime/helpers/extends.js","../../../node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","../../../node_modules/@babel/runtime/helpers/inheritsLoose.js","../src/get-video-source.js","../src/youtube-viewer.jsx","../src/types.js","../src/classNameStrategies.js","../src/typeMapper.js"],"sourcesContent":["function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nmodule.exports = _inheritsLoose;","const getVideoSrc = (src, settings = {}) => {\r\n  if (typeof src === 'object') {\r\n    if (settings && settings.getVideoUrl) {\r\n      return settings.getVideoUrl(src);\r\n    } else {\r\n      console.error('must set getVideoUrl in plugin config when using custom video source!', src); //eslint-disable-line no-console\r\n    }\r\n  }\r\n\r\n  return src;\r\n};\r\n\r\nexport default getVideoSrc;\r\n","import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport ReactPlayer from 'react-player';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport { mergeStyles, validate, Context } from 'wix-rich-content-common';\r\nimport isEqual from 'lodash/isEqual';\r\nimport getVideoSrc from './get-video-source';\r\nimport schema from '../statics/data-schema.json';\r\nimport styles from '../statics/styles/video-viewer.scss';\r\n\r\nclass YoutubeViewer extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    validate(props.componentData, schema);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (!isEqual(nextProps.componentData, this.props.componentData)) {\r\n      validate(nextProps.componentData, schema);\r\n    }\r\n  }\r\n\r\n  normalizeUrl = url => (url.toLowerCase().indexOf('vimeo') === 0 ? 'https://' + url : url); //vimeo player needs urls prefixed with http[s]\r\n\r\n  getVideoRatio = wrapper => {\r\n    const element = wrapper.querySelector('iframe, video');\r\n    return element.clientHeight / element.clientWidth;\r\n  };\r\n\r\n  fixVideoRatio = () => {\r\n    // eslint-disable-next-line react/no-find-dom-node\r\n    const wrapper = ReactDOM.findDOMNode(this).parentNode;\r\n    const ratio = this.getVideoRatio(wrapper);\r\n    wrapper.style['padding-bottom'] = ratio * 100 + '%';\r\n  };\r\n\r\n  render() {\r\n    const { componentData, settings, ...rest } = this.props;\r\n    this.styles = this.styles || mergeStyles({ styles, theme: this.context.theme });\r\n    const url = this.normalizeUrl(getVideoSrc(componentData.src, settings));\r\n    const props = { ...rest, url, onReady: this.fixVideoRatio };\r\n    return <ReactPlayer className={classNames(this.styles.video_player)} {...props} />;\r\n  }\r\n}\r\n\r\nYoutubeViewer.propTypes = {\r\n  componentData: PropTypes.object.isRequired,\r\n  onReady: PropTypes.func,\r\n  onStart: PropTypes.func,\r\n  controls: PropTypes.bool,\r\n  width: PropTypes.string,\r\n  height: PropTypes.string,\r\n  settings: PropTypes.object.isRequired,\r\n};\r\n\r\nYoutubeViewer.contextType = Context.type;\r\n\r\nYoutubeViewer.defaultProps = {\r\n  width: '100%',\r\n  height: '100%',\r\n  controls: true,\r\n};\r\n\r\nexport default YoutubeViewer;\r\n","const VIDEO_TYPE = 'wix-draft-plugin-youtube';\r\nconst VIDEO_TYPE_LEGACY = 'VIDEO-EMBED';\r\nexport { VIDEO_TYPE_LEGACY, VIDEO_TYPE };\r\n","import styles from '../statics/styles/video-viewer.scss';\r\nimport { mergeStyles } from 'wix-rich-content-common';\r\n\r\nexport const containerClassName = theme => {\r\n  const mergedStyles = mergeStyles({ styles, theme });\r\n  return mergedStyles.video_container;\r\n};\r\n","import YoutubeViewer from './youtube-viewer';\r\nimport { VIDEO_TYPE_LEGACY, VIDEO_TYPE } from './types';\r\nimport { containerClassName } from './classNameStrategies';\r\n\r\nexport const typeMapper = () => ({\r\n  [VIDEO_TYPE_LEGACY]: {\r\n    component: YoutubeViewer,\r\n    classNameStrategies: { container: containerClassName },\r\n  },\r\n  [VIDEO_TYPE]: { component: YoutubeViewer, classNameStrategies: { container: containerClassName } },\r\n});\r\n"],"names":["getVideoSrc","src","settings","getVideoUrl","console","error","YoutubeViewer","props","normalizeUrl","url","toLowerCase","indexOf","getVideoRatio","wrapper","element","querySelector","clientHeight","clientWidth","fixVideoRatio","ReactDOM","findDOMNode","parentNode","ratio","style","validate","componentData","schema","componentWillReceiveProps","nextProps","isEqual","render","rest","styles","mergeStyles","theme","context","onReady","classNames","video_player","Component","propTypes","PropTypes","object","isRequired","func","onStart","controls","bool","width","string","height","contextType","Context","type","defaultProps","VIDEO_TYPE","VIDEO_TYPE_LEGACY","containerClassName","mergedStyles","video_container","typeMapper","component","classNameStrategies","container"],"mappings":";;;;;;;;;;;;;;AAAA,SAAS,QAAQ,GAAG;EAClB,cAAc,GAAG,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,UAAU,MAAM,EAAE;IAC7D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;MACzC,IAAI,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;;MAE1B,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;QACtB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;UACrD,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;SAC3B;OACF;KACF;;IAED,OAAO,MAAM,CAAC;GACf,CAAC;;EAEF,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;CACxC;;AAED,cAAc,GAAG,QAAQ;;;AClBzB,SAAS,6BAA6B,CAAC,MAAM,EAAE,QAAQ,EAAE;EACvD,IAAI,MAAM,IAAI,IAAI,EAAE,OAAO,EAAE,CAAC;EAC9B,IAAI,MAAM,GAAG,EAAE,CAAC;EAChB,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACrC,IAAI,GAAG,EAAE,CAAC,CAAC;;EAEX,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IACtC,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;IACpB,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,SAAS;IACzC,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;GAC3B;;EAED,OAAO,MAAM,CAAC;CACf;;AAED,gCAAc,GAAG,6BAA6B;;ACf9C,SAAS,cAAc,CAAC,QAAQ,EAAE,UAAU,EAAE;EAC5C,QAAQ,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;EACzD,QAAQ,CAAC,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC;EAC1C,QAAQ,CAAC,SAAS,GAAG,UAAU,CAAC;CACjC;;AAED,iBAAc,GAAG,cAAc;;ACN/B,IAAMA,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,QAAN,EAAwB;MAAlBA,QAAkB;IAAlBA,QAAkB,GAAP,EAAO;;;MACtC,OAAOD,GAAP,KAAe,QAAnB,EAA6B;QACvBC,QAAQ,IAAIA,QAAQ,CAACC,WAAzB,EAAsC;aAC7BD,QAAQ,CAACC,WAAT,CAAqBF,GAArB,CAAP;KADF,MAEO;MACLG,OAAO,CAACC,KAAR,CAAc,uEAAd,EAAuFJ,GAAvF,EADK;;;;SAKFA,GAAP;CATF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICWMK;;;;;yBACQC,KAAZ,EAAmB;;;kCACXA,KAAN;;UAUFC,YAXmB,GAWJ,UAAAC,GAAG;aAAKA,GAAG,CAACC,WAAJ,GAAkBC,OAAlB,CAA0B,OAA1B,MAAuC,CAAvC,GAA2C,aAAaF,GAAxD,GAA8DA,GAAnE;KAXC;;UAanBG,aAbmB,GAaH,UAAAC,OAAO,EAAI;UACnBC,OAAO,GAAGD,OAAO,CAACE,aAAR,CAAsB,eAAtB,CAAhB;aACOD,OAAO,CAACE,YAAR,GAAuBF,OAAO,CAACG,WAAtC;KAfiB;;UAkBnBC,aAlBmB,GAkBH,YAAM;;UAEdL,OAAO,GAAGM,QAAQ,CAACC,WAAT,gCAA2BC,UAA3C;;UACMC,KAAK,GAAG,MAAKV,aAAL,CAAmBC,OAAnB,CAAd;;MACAA,OAAO,CAACU,KAAR,CAAc,gBAAd,IAAkCD,KAAK,GAAG,GAAR,GAAc,GAAhD;KAtBiB;;IAEjBE,QAAQ,CAACjB,KAAK,CAACkB,aAAP,EAAsBC,MAAtB,CAAR;;;;;;SAGFC,4BAAA,mCAA0BC,SAA1B,EAAqC;QAC/B,CAACC,OAAO,CAACD,SAAS,CAACH,aAAX,EAA0B,KAAKlB,KAAL,CAAWkB,aAArC,CAAZ,EAAiE;MAC/DD,QAAQ,CAACI,SAAS,CAACH,aAAX,EAA0BC,MAA1B,CAAR;;;;SAkBJI,SAAA,kBAAS;sBACsC,KAAKvB,KAD3C;QACCkB,aADD,eACCA,aADD;QACgBvB,QADhB,eACgBA,QADhB;QAC6B6B,IAD7B;;SAEFC,MAAL,GAAc,KAAKA,MAAL,IAAeC,WAAW,CAAC;MAAED,MAAM,EAANA,MAAF;MAAUE,KAAK,EAAE,KAAKC,OAAL,CAAaD;KAA/B,CAAxC;QACMzB,GAAG,GAAG,KAAKD,YAAL,CAAkBR,WAAW,CAACyB,aAAa,CAACxB,GAAf,EAAoBC,QAApB,CAA7B,CAAZ;;QACMK,KAAK,kBAAQwB,IAAR;MAActB,GAAG,EAAHA,GAAd;MAAmB2B,OAAO,EAAE,KAAKlB;MAA5C;;WACO,oBAAC,WAAD;MAAa,SAAS,EAAEmB,UAAU,CAAC,KAAKL,MAAL,CAAYM,YAAb;OAAgC/B,KAAlE,EAAP;;;;EA/BwBgC;;AAmC5BjC,aAAa,CAACkC,SAAd,GAA0B;EACxBf,aAAa,EAAEgB,SAAS,CAACC,MAAV,CAAiBC,UADR;EAExBP,OAAO,EAAEK,SAAS,CAACG,IAFK;EAGxBC,OAAO,EAAEJ,SAAS,CAACG,IAHK;EAIxBE,QAAQ,EAAEL,SAAS,CAACM,IAJI;EAKxBC,KAAK,EAAEP,SAAS,CAACQ,MALO;EAMxBC,MAAM,EAAET,SAAS,CAACQ,MANM;EAOxB/C,QAAQ,EAAEuC,SAAS,CAACC,MAAV,CAAiBC;CAP7B;AAUArC,aAAa,CAAC6C,WAAd,GAA4BC,OAAO,CAACC,IAApC;AAEA/C,aAAa,CAACgD,YAAd,GAA6B;EAC3BN,KAAK,EAAE,MADoB;EAE3BE,MAAM,EAAE,MAFmB;EAG3BJ,QAAQ,EAAE;CAHZ;;IC1DMS,UAAU,GAAG,0BAAnB;AACA,IAAMC,iBAAiB,GAAG,aAA1B;;ACEO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAvB,KAAK,EAAI;MACnCwB,YAAY,GAAGzB,WAAW,CAAC;IAAED,MAAM,EAANA,MAAF;IAAUE,KAAK,EAALA;GAAX,CAAhC;SACOwB,YAAY,CAACC,eAApB;CAFK;;ICCMC,UAAU,GAAG,SAAbA,UAAa;;;yBACvBJ,iBADuB,IACH;IACnBK,SAAS,EAAEvD,aADQ;IAEnBwD,mBAAmB,EAAE;MAAEC,SAAS,EAAEN;;GAHZ,OAKvBF,UALuB,IAKV;IAAEM,SAAS,EAAEvD,aAAb;IAA4BwD,mBAAmB,EAAE;MAAEC,SAAS,EAAEN;;GALpD;CAAnB;;;;"}